<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Scenario Creator</title>

    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/dialogue.css">
    <link rel="stylesheet" href="styles/editor.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>

<body>
    <div id="dialogue-main" class="edit-mode">
        <div class="layer-world" id="layer-world">
            <div id="layer-background">
                <img src="https://skuqre.github.io/nikke-font-generator/images/dialogue/bgs/CommanderRoom.png" alt="">
            </div>
            <div id="layer-character"></div>
        </div>
        <div id="layer-gradient">
            <div class="overlay-sides"></div>
            <div id="overlay-main">
                <div style="left: 0; bottom: 0; opacity: 0; height: 322px" id="gds"></div>
                <img src="../assets/images/gradients/gradientD_C.png" draggable="false" alt="Choice gradient. Why are you seeing this?" style="left: 0; bottom: 0; opacity: 1;" id="gdc" />
                <img src="../assets/images/gradients/gradientU.png" draggable="false" alt="Top gradient. Why are you seeing this?" style="top: 0; left: 0;" id="gdt" />
                <img src="../assets/images/gradients/gradientL.png" draggable="false" alt="Left gradient. Why are you seeing this?" style="top: 0; left: 0;" />
                <img src="../assets/images/gradients/gradientR.png" draggable="false" alt="Right gradient. Why are you seeing this?" style="top: 0; right: 0;" />

            </div>
            <div class="overlay-sides"></div>
        </div>
        <div id="layer-dialogue">
            <div id="dialogue-container-speech" style="opacity: 0;">
                <div id="dialogue-deco-color-bar"></div>
                <div id="dialogue-text-speaker"></div>
                <div id="dialogue-text-content"></div>
            </div>

            <div id="dialogue-container-choices" style="opacity: 0;" class="list choices"></div>

            <div id="dialogue-container-narration" style="opacity: 0;">
                <div id="dialogue-element-narrationbox"><span></span></div>
            </div>

            <div id="dialogue-container-misc">
                <img src="../assets/images/pointer.png" alt="Dialogue pointer. Why are you seeing this?" id="dialogue-deco-pointer" style="opacity: 0;" />
            </div>
        </div>
        <div id="layer-controls">
            <div id="control-button-skip" style="left: 1831px; top: 10px;">
                <img src="../assets/images/icons/icon_skip.png" alt="Skip" style="scale: 0.2264150943; top: -46px; left: -81px;" />
                <span>SKIP</span>
                <div id="button-skip-hitbox" class="button-hitbox" style="top: 2px; left: -30px;">
                    <div class="keybind-display">]</div>
                </div>
            </div>
            <div id="control-button-log" style="left: 1744px; top: 10px;">
                <img src="../assets/images/icons/icon_log.png" alt="Log" style="scale: 0.2133333333; top: -47px; left: -84px;" />
                <span>LOG</span>
                <div id="button-log-hitbox" class="button-hitbox" style="top: 2px; left: -38px;">
                    <div class="keybind-display">TAB</div>
                </div>
            </div>
            <div id="control-button-auto" style="left: 1646px; top: 10px;">
                <img src="../assets/images/icons/icon_auto.png" id="control-icon-auto" alt="Auto" style="scale: 0.2133333333; top: -47px; left: -85px;" />
                <span>AUTO</span>
                <div id="button-auto-hitbox" class="button-hitbox" style="top: 2px; left: -35px;">
                    <div class="keybind-display">LSHIFT</div>
                </div>
            </div>
            <div id="control-button-hide" style="left: 1555px; top: 10px;">
                <img src="../assets/images/icons/icon_hide.png" alt="Hide" style="scale: 0.4375; top: -47px; left: -88px;" />
                <span>HIDE</span>
                <div id="button-hide-hitbox" class="button-hitbox" style="top: 2px; left: -40px;">
                    <div class="keybind-display">H</div>
                </div>
            </div>
        </div>
    </div>

    <div class="editor-main" id="editor-main">
        <div class="generic-double">
            <div id="character-main" style="width: calc(50% - 1px);">
                <div class="generic-header">
                    <span>Characters</span>
                    <div class="button-tray">
                        <div class="button white" id="colordef-open">
                            <i class="bx bxs-palette"></i>
                        </div>
                        <div class="button green" id="character-add">
                            <i class="bx bx-plus"></i>
                        </div>
                        <div class="button red" id="character-del">
                            <i class="bx bx-minus"></i>
                        </div>
                    </div>
                </div>
                <div class="generic-list alternating" id="editor-character-list">
                </div>
            </div>
            <div id="inspector-main">
                <div class="generic-header">
                    <span>Inspector</span>
                    <div class="button-tray">
                        <div class="button white" id="world-open">
                            <i class="bx bx-world"></i>
                        </div>
                    </div>
                </div>
                <div class="generic-panel" id="editor-inspector-list">

                    <div class="field-group-character">
                        <b>Character ID (read-only)</b>
                        <input type="text" id="field-character-charid" disabled />
                    </div>
                    <div class="field-group-character">
                        <b>Name</b>
                        <input type="text" id="field-character-name" />
                    </div>
                    <div class="field-group-character" title="A model can have variants, like how Anis: Sparkling Summer has a tableless variant.">
                        <b>Model Variant</b>
                        <select id="field-character-variant">
                            <option value="null">Automatic</option>
                        </select>
                    </div>
                    <div class="field-group-character">
                        <hr>
                    </div>
                    <div class="field-group-character">
                        <b>Initial Emotion</b>
                        <select id="field-character-initanim">
                            <option value="null">Automatic</option>
                        </select>
                    </div>
                    <div class="field-group-character field-double stretchy">
                        <b>Initial X</b>
                        <input type="number" id="field-character-initx" step="10">
                    </div>
                    <div class="field-group-character field-double stretchy">
                        <b>Initial Y</b>
                        <input type="number" id="field-character-inity" step="10">
                    </div>
                    <div class="field-group-character field-double stretchy">
                        <b>Initial Rotate</b>
                        <input type="number" id="field-character-initr" step="10">
                    </div>
                    <div class="field-group-character field-double stretchy">
                        <b>Initial Scale</b>
                        <input type="number" id="field-character-inits" step="0.1">
                    </div>
                    <div class="field-group-character field-double stretchy">
                        <b>Initial Opacity</b>
                        <input type="number" id="field-character-inito" step="0.1" min="0" max="1">
                    </div>

                    <div class="field-group-world field-double stretchy">
                        <b>Initial Camera X</b>
                        <input type="number" id="field-world-initcamx" step="10">
                    </div>
                    <div class="field-group-world field-double stretchy">
                        <b>Initial Camera Y</b>
                        <input type="number" id="field-world-initcamy" step="10">
                    </div>
                    <div class="field-group-world field-double stretchy">
                        <b>Initial Camera Zoom</b>
                        <input type="number" id="field-world-initcamz" step="0.1">
                    </div>
                    <div class="field-group-world field-double stretchy">
                        <b>Initial Camera Rotate</b>
                        <input type="number" id="field-world-initcamr" step="10">
                    </div>

                </div>
            </div>
        </div>
        <div class="generic-double" style="top: 50%">
            <div id="dialogue-list-main" style="width: calc(50% - 1px);">
                <div class="generic-header">
                    <span>Dialogue</span>
                    <div class="button-tray">
                        <div class="button green" id="dialogue-add">
                            <i class="bx bx-plus"></i>
                        </div>
                        <div class="button red" id="dialogue-del">
                            <i class="bx bx-minus"></i>
                        </div>
                    </div>
                </div>
                <div class="generic-list alternating" id="editor-dialogue-list">
                </div>
            </div>
            <div id="dialogue-edit-main">
                <div class="generic-header">
                    <span>Edit</span>
                </div>

                <div class="generic-panel" id="editor-edit-list" style="display: none;">
                    <div>
                        <b>Type</b>
                        <select id="field-dialogue-type">
                            <option value="Speech">Speech</option>
                            <option value="Choice">Choice</option>
                            <option value="Narration">Narration</option>
                            <option value="Monologue">Monologue</option>
                        </select>
                    </div>
                    <hr>

                    <div class="field-group-speech">
                        <b>Character ID (to speak)</b>
                        <select id="field-dialogue-charid">
                            <option value="none">None</option>
                        </select>
                    </div>
                    <div class="field-group-speech">
                        <b>Emotion</b>
                        <select id="field-dialogue-emotion"></select>
                        <div class="generic-button white fullwidth" id="field-dialogue-matchinit">Match initial emotion</div>
                    </div>
                    <div class="field-group-speech">
                        <hr>
                    </div>
                    <div class="field-group-speech">
                        <b>Name</b>
                        <input type="text" id="field-dialogue-name" placeholder="Speaker's name here..." />
                    </div>
                    <div class="field-group-speech">
                        <b>Content</b>
                        <textarea id="field-dialogue-content"></textarea>
                    </div>

                    <div class="field-group-narration">
                        <b>Content</b>
                        <textarea id="field-dialogue-ncontent"></textarea>
                    </div>

                    <div class="field-group-monologue">
                        <b>Content</b>
                        <textarea id="field-dialogue-mcontent"></textarea>
                    </div>

                    <hr class="field-group-all">

                    <div class="field-group-all field-double stretchy">
                        <div>
                            <b>Focus to X</b>
                            <div class="button white" id="field-dialogue-focx"></div>
                        </div>
                        <input type="number" id="field-dialogue-foctox" step="10">
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <div>
                            <b>Focus to Y</b>
                            <div class="button white" id="field-dialogue-focy"></div>
                        </div>
                        <input type="number" id="field-dialogue-foctoy" step="10">
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <div>
                            <b>Focus Zoom</b>
                            <div class="button white" id="field-dialogue-focz"></div>
                        </div>
                        <input type="number" id="field-dialogue-foctoz" step="0.1">
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <div>
                            <b>Focus Rotate</b>
                            <div class="button white" id="field-dialogue-focr"></div>
                        </div>
                        <input type="number" id="field-dialogue-foctor" step="10">
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <b>Focus Duration</b>
                        <input type="number" id="field-dialogue-focd" step="0.1" value="0.5" min="0">
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <b>Ease Type</b>
                        <select id="field-dialogue-foceasetype"></select>
                    </div>
                    <div class="field-group-all field-double stretchy">
                        <b>Ease Direction</b>
                        <select id="field-dialogue-foceasedir">
                            <option value="In">In</option>
                            <option value="Out">Out</option>
                            <option value="InOut">In and Out</option>
                        </select>
                    </div>

                    <hr class="field-group-all">

                    <div class="field-group-all field-double stretchy">
                        <b>Timeline Duration</b>
                        <input type="number" id="field-dialogue-tldur" step="0.1" value="0" min="0">
                    </div>
                </div>
                <div class="generic-panel" id="editor-edit-inst">
                    <span>Select a dialogue entry to get started.</span>
                </div>
            </div>
        </div>
        <div class="generic-double" style="top: 50%; left: 50%">
            <div style="max-width: 100%; width: 100%; flex-basis: 100%;">
                <div class="generic-header">
                    <div class="button-tray">
                        <div class="button white" id="timeline-present">
                            <i class="bx bx-slideshow"></i>
                        </div>
                    </div>
                    <div class="button-tray">
                        <div class="button white" id="timeline-zero">
                            <i class="bx bx-skip-previous"></i>
                        </div>
                        <div class="button white" id="timeline-pause">
                            <i class="bx bx-pause"></i>
                        </div>
                        <div class="button white" id="timeline-play">
                            <i class="bx bx-play"></i>
                        </div>
                        <div class="button white" id="timeline-end">
                            <i class="bx bx-skip-next"></i>
                        </div>
                    </div>
                    <div class="button-tray">
                        <input type="text" class="time-input" id="field-timeline-curtime">
                        <span>/</span>
                        <input type="text" class="time-input" id="field-timeline-maxtime">
                        <input type="number" class="time-input" style="text-align: left;" step="0.1" min="0" value="1" id="field-timeline-zoom">
                    </div>
                </div>
                <div class="timeline-wrapper">
                    <div id="timeline-main" class="timeline">
                    </div>
                    <div id="timeline-scrubber" class="timeline">
                        <div class="timeline-pos-line" id="timeline-end-line" style="background-color: palegreen;" title="This marks the end of the dialogue.">
                            <div class="pos-line-deco-head-end" id="timeline-end-head"></div>
                        </div>

                        <div class="timeline-pos-line" id="timeline-line" title="This marks where you are at the time of the dialogue.">
                            <div class="pos-line-deco-head" id="timeline-head">
                                <div class="pos-line-deco-butt"></div>
                            </div>
                        </div>
                    </div>
                    <div id="timeline-blocker" class="timeline">
                        <span></span>
                    </div>
                </div>
                
            </div>
        </div>
        <!-- <div class="generic-double" style="left: 50%">
            <div id="viewport-main" style="max-width: 100%; width: 100%; flex-basis: 100%;">
                <div class="button-tray" id="viewport-edit-main">
                    <div class="button white" id="viewport-edit-move">
                        <i class='bx bx-move'></i>
                    </div>
                    <div class="button white" id="viewport-edit-rotate">
                        <i class='bx bx-refresh'></i>
                    </div>
                    <div class="button white" id="viewport-edit-scale">
                        <i class='bx bx-area'></i>
                    </div>
                </div>
            </div>
        </div> -->
    </div>

    <div class="generic-popup" id="colordef-main" style="opacity: 0; display: none;">
        <div class="popup-main">
            <h2>Color Definitions</h2>
            <div class="generic-button white fullwidth" id="colordef-add">Add new definition</div>
            <div class="generic-list alternating" id="colordef-list"></div>
            <div class="popup-button-tray">
                <div class="button green" id="colordef-save">Save</div>
            </div>
        </div>
    </div>

    <div class="generic-popup" id="modeladd-main" style="display: none;">
        <div class="popup-main" id="modeladd-selector" style="display: flex;">
            <h2>Add Model</h2>
            <span>
                A model is typically 3 or more files. It is a <code>.skel</code>, <code>.atlas</code>, and one or more <code>.png</code>
                file trio that work together to make a moving image.
            </span>
            <hr>
            <div class="generic-button white fullwidth" id="modeladd-search"><i class="bx bx-search"></i> &nbsp; Look through NKAS</div>
            <span>Look for a model through the NKAS catalog.</span>
            <hr>
            <div class="generic-button white fullwidth" id="modeladd-load"><i class="bx bx-folder"></i> &nbsp; Locally loaded files</div>
            <span>Look through locally loaded files, or load new ones.</span>
        </div>

        <div class="popup-main" id="model-load" style="width: 70%; max-width: unset; display: none;">
            <h2>Loaded Models</h2>
            <div class="generic-list alternating" id="model-load-list">
            </div>
            <div class="popup-button-tray">
                <div class="button green" id="model-loader" style="width: max-content;">Load new model</div>
                <div class="button white" id="model-folder" style="width: max-content;">Open Folder</div>
            </div>
        </div>

        <div class="popup-main" id="model-search" style="width: 70%; max-width: unset; display: none;">
            <h2>NKAS Catalog</h2>
            <div class="input-tray">
                <input type="text" name="" id="model-search-query" placeholder="🔎">
                <div class="generic-button white" id="model-search-refresh">Refresh</div>
            </div>
            <div class="generic-list alternating" id="model-search-list">
            </div>
            <div class="popup-button-tray">
                <div class="button green" id="model-search-exit">Reload</div>
            </div>
        </div>
    </div>

    <div class="generic-popup" id="loading-screen" style="display: none;">
        <div>
            <h1><i class='bx bx-loader-alt bx-spin'></i></h1>
            <span id="loading-text">Loading...</span>
        </div>
    </div>

    <script src="./spine/spine-player40.js"></script>
    <script src="./spine/spine-player41.js"></script>

    <script src="./scripts/util.js"></script>
    <script src="./scripts/character.js"></script>
    <script src="./scripts/dialogue.js" type="module"></script>
</body>

</html>